<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>travel loader</title>

    <style>
		*, *::before, *::after {
			box-sizing: inherit;
		}

        body{
            margin: 0;
            overflow: hidden;
			box-sizing: border-box;
        }

        /*  */

        .nightMode {
            position: absolute;
            bottom: 10%;
        }

        .nightModeSwitch {
			display: block;
			width: 80px;
			height: 48px;
			border-radius: 24px;
			background-color: #fff4dd;
			padding: 4px;
			cursor: pointer;
            box-shadow: 0px 6px 24px rgba(29, 107, 178, 0.26);
			transition: background-color 500ms ease;
		}

		.nightModeSwitch::before {
			content: '';
			position: absolute;
			border-top: 20px solid;
			border-top-color: #feb01b;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			transform: rotate(-45deg);
            transition-property: transform, border-top-color;
            transition-duration: 500ms
		}

		input[name="nightMode"] {
			display: none;
		}

		input[name="nightMode"]:checked + .nightModeSwitch::before {
			transform: translateX(80%) rotate(45deg);
			border-top-color: #d4edff;
		}

		input[name="nightMode"]:checked + .nightModeSwitch {
			background-color: #1f3a62;
		}

        /*  */

        .loader__wrap {
            position: relative;
            display: flex;
            justify-content: center;
		    align-items: center;
            flex-direction: column;
            background: linear-gradient(#228FD7, #F1F5F8);
            height: 100vh;
            margin: 0;
            overflow: hidden;
            z-index: 100;
        }

        .loaderNightGlow::before {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            content: '';
            width: 310px;
            height: 310px;
            margin: 0 auto;
            box-shadow: 0 0 200px #314a79;
            border-radius: 50%;
        }

        #travelLoader{
            display:block;
            width:416px;
            height:320px;
            overflow: hidden;
        }

        .travelLoader__bg {
            background: linear-gradient(#0f132a, #18224a);
            content: '';    
            display: block;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            opacity: 0;
            z-index: -100;
            pointer-events: none;
            transition: opacity 1000ms;
        }

        .loader__rockClr--light,
        .loader__rockClr--dark,
        .loader__rockShadowClr,
        .loader__tree--light,
        .loader__tree--dark,
        .loader__oceanClr,
        .loader__cloudClr,
        .loader__swirlClr,
        .loader__birdClr,
        #loader__wrap,
        .shiningCont,
        .sun,
        .moon,
        .blick,
        .stars__sky {
            transition-property: fill, transform, opacity;
            transition-duration: 1000ms;
        }

        stop {
            transition: stop-color 1000ms;
        }

    </style>
</head>
<body>
    <div id="loader__wrap" class="loader__wrap">
        <div class="travelLoader__bg"></div>
        <div id="travelLoader"></div>
        <label class="nightMode">
            <input type="checkbox" name="nightMode">
            <span class="nightModeSwitch"></span>
        </label>
    </div>


    <script src="../js/lottie_svg.min.js"></script>

    <script>
        let travelLoaderContainer = document.getElementById('travelLoader'),
        travelLoaderParams = bodymovin.loadAnimation({
            container: travelLoaderContainer,
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: 'data.json'
        });

        travelLoaderParams.addEventListener('DOMLoaded', function() {

            let select = function(selector) {
                return document.querySelector(selector);
            },        
            selectAll = function(selector) {
                return document.querySelectorAll(selector);
            },
            selectID = function(id) {
                return document.getElementById(id);
            },

            // Trees
            loader__tree_light = selectAll('.loader__tree--light'),
            loader__tree_dark = selectAll('.loader__tree--dark'),

            // Birds
            loader__birdClr = selectAll('.loader__birdClr'),

            // Rocks
            loader__rockClr_light = selectAll('.loader__rockClr--light'),
            loader__rockClr_dark = selectAll('.loader__rockClr--dark'),
            loader__rockShadowClr = selectAll('.loader__rockShadowClr')

            // Ocean
            loader__oceanClr = selectAll('.loader__oceanClr'),

            // Clouds
            loader__cloudClr = selectAll('.loader__cloudClr'),
            loader__swirlClr = selectAll('.loader__swirlClr'),

            loader__wrap = selectID('loader__wrap'),
            travelLoader__bg = select('.travelLoader__bg'),

            // loader gradients colors
            loader__bgGrd = selectID('loader__bgGrd'),
            loader__balloonGrd = selectID('loader__balloonGrd')

            // Sun, shining and water reflection
            shining = selectAll('.shiningCont'),
            sun = selectAll('.sun'),
            moon = selectAll('.moon'),
            // blick = selectAll('.blick'),
            stars = selectAll('.stars__sky'),

            nightMode = select('input[name="nightMode"]'),

            bgElementsClrs = ['#001936', '#0E2E52', '#141428', '#1C2B4D', '#18233D', '#0E1A36', '#001036', '#141428'],
            bgElementsArray = [loader__tree_dark, loader__tree_light, loader__birdClr, loader__rockClr_light, loader__rockClr_dark, loader__rockShadowClr, loader__oceanClr, loader__cloudClr, shining, loader__swirlClr, sun, moon, stars]


            // Apply fill and stroke to SVG elements
            function applyFill(element, fillClr) {
                for (i = 0; i < element.length; ++i) {
                    element[i].setAttribute('style', 'fill:' + fillClr +';');
                }
            }

            function applyStroke(element, strokeClr) {
                for (i = 0; i < element.length; ++i) {
                    element[i].setAttribute('style', 'stroke:' + strokeClr +';');
                }
            }

            function clearStyle(element) {
                for (i = 0; i < element.length; ++i) {
                    element[i].removeAttribute('style');
                }
            }

            // Apply styles to an element
            function applyStyles(element, transformation, visibility) {
                for (i = 0; i < element.length; ++i) {
                    element[i].setAttribute('style', 'transform:' + transformation +';' + 'opacity:' + visibility +';');
                }
            }

            // Search for SVG gradient IDs. Apply styles to stops 
            function grdColors(element, ...grdStopsClrs) {

                let getGrdID = element.getAttribute('fill').replace(/(url)[(]|[)]/g, ''),
                getGrdStops = document.querySelectorAll(getGrdID + '> stop');

                for (i=0; i < getGrdStops.length; ++i) {
                    getGrdStops[i].style.stopColor = grdStopsClrs[i];
                }
            }


            nightMode.addEventListener('change', function() {

                if (nightMode.checked) {

                    travelLoader__bg.setAttribute('style', 'opacity: 1;');

                    // loader wrap night mode backround gradient and glow
                    loader__wrap.classList.add('loaderNightGlow');

                    // element, grdStopClr0, grdStopClr1, grdStopClr2
                    grdColors(loader__bgGrd, '#1f3a62', '#182645', '#101028');
                    grdColors(loader__balloonGrd, '#001936', '#002f4d', '#ffcc00');

                    // apply style attributes
                    let i, len;
                    for (i = 0, len = bgElementsArray.length; i < len; ++i) {
                        applyFill(bgElementsArray[i], bgElementsClrs[i]);
                    }

                    applyStroke(loader__swirlClr, '#141428');

                    applyStyles(shining, '', '0');
                    applyStyles(sun, 'matrix(1,0,0,1,0,100)', '0');
                    applyStyles(moon, 'matrix(1,0,0,1,174,204)', '1');
                    applyStyles(stars, '', '1');
                } 
                
                else {

                    travelLoader__bg.setAttribute('style', 'opacity: 0;');

                    loader__wrap.classList.remove('loaderNightGlow');

                    // element, grdStopClr0, grdStopClr1, grdStopClr2
                    grdColors(loader__bgGrd, '', '', '');
                    grdColors(loader__balloonGrd, '', '', '');

                    // clear style attribute
                    let i, len;
                    for (i = 0, len = bgElementsArray.length; i < len; ++i) {
                        clearStyle(bgElementsArray[i]);
                    }
                }
            });
        });
    </script>
</body>
</html>